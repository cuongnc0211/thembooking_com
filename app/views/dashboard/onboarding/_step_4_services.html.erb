<%= form_with model: @business, url: dashboard_onboarding_path, method: :patch, class: "space-y-6",
    data: { controller: "nested-form" } do |form| %>

  <p class="text-sm text-slate-600 bg-blue-50 p-3 rounded-lg">
    Add at least one service. You can add more services later from your dashboard.
  </p>

  <%= hidden_field_tag :current_step, @step %>

  <!-- Template for new services -->
  <template data-nested-form-target="template">
    <%= form.fields_for :services, Service.new, child_index: 'NEW_RECORD' do |service_form| %>
      <%= render "service_fields", form: service_form, base_record: false %>
    <% end %>
  </template>

  <%= form.fields_for :services, @business.services.presence || [Service.new] do |service_form| %>
    <%= render "service_fields", form: service_form, base_record: true %>
  <% end %>
  <!-- Nested form container -->
  <div data-nested-form-target="target">
    
  </div>

  <!-- Add service button -->
  <button type="button" class="btn-secondary w-full"
      data-action="click->nested-form#add">
    + Add Another Service
  </button>

  <div class="pt-4">
    <%= submit_tag "Complete Setup", class: "btn-primary w-full cursor-pointer" %>
  </div>
<% end %>